[2025-07-05T13:22:39.995+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-05T13:22:40.007+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T13:22:30.860692+00:00 [queued]>
[2025-07-05T13:22:40.011+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T13:22:30.860692+00:00 [queued]>
[2025-07-05T13:22:40.012+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-07-05T13:22:40.019+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): transform_and_load> on 2025-07-05 13:22:30.860692+00:00
[2025-07-05T13:22:40.022+0000] {clientserver.py:570} INFO - Closing down clientserver connection
[2025-07-05T13:22:40.023+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=3979) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-07-05T13:22:40.023+0000] {standard_task_runner.py:63} INFO - Started process 4114 to run task
[2025-07-05T13:22:40.025+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'practice_etl_pipeline', 'transform_and_load', 'manual__2025-07-05T13:22:30.860692+00:00', '--job-id', '113', '--raw', '--subdir', 'DAGS_FOLDER/main.py', '--cfg-path', '/tmp/tmpzi58ingg']
[2025-07-05T13:22:40.027+0000] {standard_task_runner.py:91} INFO - Job 113: Subtask transform_and_load
[2025-07-05T13:22:40.063+0000] {task_command.py:426} INFO - Running <TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T13:22:30.860692+00:00 [running]> on host 93b0937d74ff
[2025-07-05T13:22:40.109+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='practice_etl_pipeline' AIRFLOW_CTX_TASK_ID='transform_and_load' AIRFLOW_CTX_EXECUTION_DATE='2025-07-05T13:22:30.860692+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-07-05T13:22:30.860692+00:00'
[2025-07-05T13:22:40.109+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-05T13:22:40.596+0000] {clientserver.py:529} INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/opt/spark/spark-4.0.0-bin-hadoop3/python/lib/py4j-0.10.9.9-src.zip/py4j/clientserver.py", line 527, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
[2025-07-05T13:22:40.597+0000] {clientserver.py:570} INFO - Closing down clientserver connection
[2025-07-05T13:22:40.597+0000] {java_gateway.py:1056} INFO - Exception while sending command.
Traceback (most recent call last):
  File "/opt/spark/spark-4.0.0-bin-hadoop3/python/lib/py4j-0.10.9.9-src.zip/py4j/clientserver.py", line 527, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/spark/spark-4.0.0-bin-hadoop3/python/lib/py4j-0.10.9.9-src.zip/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/spark/spark-4.0.0-bin-hadoop3/python/lib/py4j-0.10.9.9-src.zip/py4j/clientserver.py", line 530, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
[2025-07-05T13:22:40.599+0000] {clientserver.py:570} INFO - Closing down clientserver connection
[2025-07-05T13:22:41.505+0000] {logging_mixin.py:188} INFO - +--------------------+
|                 _c0|
+--------------------+
|31.12.2017;395775...|
|31.12.2017;15423;...|
|31.12.2017;298332...|
|31.12.2017;17434;...|
|31.12.2017;310405...|
|31.12.2017;22798;...|
|31.12.2017;13800;...|
|31.12.2017;13905;...|
|31.12.2017;40266;...|
|31.12.2017;341567...|
|31.12.2017;14912;...|
|31.12.2017;13871;...|
|31.12.2017;364395...|
|31.12.2017;14138;...|
|31.12.2017;17441;...|
|31.12.2017;18164;...|
|31.12.2017;14878;...|
|31.12.2017;341569...|
|31.12.2017;14913;...|
|31.12.2017;18007;...|
+--------------------+
only showing top 20 rows
[2025-07-05T13:22:45.755+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_ft_balance_f|115    |
+----------+------+-------------------------------------------+-------+
[2025-07-05T13:22:46.017+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                       |obj_num|
+----------+------+--------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.ft_balance_f: DataFrameReader.jdbc() missing 1 required positional argument: 'url'|115    |
+----------+------+--------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T13:22:46.412+0000] {logging_mixin.py:188} INFO - +--------------------+
|                 _c0|
+--------------------+
|09-01-2018;873663...|
|09-01-2018;176169...|
|09-01-2018;409685...|
|09-01-2018;156987...|
|09-01-2018;120483...|
|09-01-2018;311159...|
|10-01-2018;873663...|
|10-01-2018;393808...|
|10-01-2018;37051;...|
|10-01-2018;13630;...|
|10-01-2018;37051;...|
|10-01-2018;176270...|
|10-01-2018;393808...|
|11-01-2018;13630;...|
|11-01-2018;434141...|
|11-01-2018;311161...|
|11-01-2018;37051;...|
|11-01-2018;176169...|
|12-01-2018;393808...|
|12-01-2018;434141...|
+--------------------+
only showing top 20 rows
[2025-07-05T13:22:58.313+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_ft_posting_f|33893  |
+----------+------+-------------------------------------------+-------+
[2025-07-05T13:22:58.564+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                       |obj_num|
+----------+------+--------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.ft_posting_f: DataFrameReader.jdbc() missing 1 required positional argument: 'url'|33893  |
+----------+------+--------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T13:22:58.713+0000] {logging_mixin.py:188} INFO - +--------------------+
|                 _c0|
+--------------------+
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
|2018-01-01;2018-0...|
+--------------------+
only showing top 20 rows
[2025-07-05T13:23:02.047+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_account_d|113    |
+----------+------+-------------------------------------------+-------+
[2025-07-05T13:23:02.275+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                       |obj_num|
+----------+------+--------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_account_d: DataFrameReader.jdbc() missing 1 required positional argument: 'url'|113    |
+----------+------+--------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T13:23:02.469+0000] {logging_mixin.py:188} INFO - +--------------------+
|                 _c0|
+--------------------+
|37;2017-05-11;205...|
|40;2017-05-11;205...|
|529511969;2017-12...|
|CURRENCY_RK;DATA_...|
|63;2017-05-11;205...|
|26;2017-05-11;205...|
|29;2017-05-11;205...|
|38;2017-05-11;205...|
|46;2017-05-11;205...|
|35;2017-05-11;205...|
|39;2017-05-11;205...|
|30;2017-05-11;205...|
|48;2017-05-11;205...|
|52;2017-05-11;205...|
|56;2017-05-11;205...|
|59;2017-05-11;205...|
|60;2017-05-11;205...|
|32;2017-05-11;205...|
|23;2017-05-11;205...|
|25;2017-05-11;205...|
+--------------------+
only showing top 20 rows
[2025-07-05T13:23:05.613+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------+-------+
|timestamp |status|message                                     |obj_num|
+----------+------+--------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_currency_d|51     |
+----------+------+--------------------------------------------+-------+
[2025-07-05T13:23:05.759+0000] {logging_mixin.py:188} INFO - +----------+------+---------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                        |obj_num|
+----------+------+---------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_currency_d: DataFrameReader.jdbc() missing 1 required positional argument: 'url'|51     |
+----------+------+---------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T13:23:05.908+0000] {logging_mixin.py:188} INFO - +--------------------+
|                 _c0|
+--------------------+
|2018-01-30;2018-0...|
|2018-01-19;2018-0...|
|2018-01-10;2018-0...|
|2018-01-12;2018-0...|
|2018-01-12;2018-0...|
|2018-01-27;2018-0...|
|2018-01-10;2018-0...|
|2018-01-10;2018-0...|
|2018-01-25;2018-0...|
|2018-01-20;2018-0...|
|2018-01-13;2018-0...|
|DATA_ACTUAL_DATE;...|
|2018-01-17;2018-0...|
|2018-01-20;2018-0...|
|2018-01-18;2018-0...|
|2018-01-16;2018-0...|
|2018-01-12;2018-0...|
|2018-01-11;2018-0...|
|2017-12-30;2018-0...|
|2018-01-23;2018-0...|
+--------------------+
only showing top 20 rows
[2025-07-05T13:23:09.117+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------------+-------+
|timestamp |status|message                                          |obj_num|
+----------+------+-------------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_exchange_rate_d|461    |
+----------+------+-------------------------------------------------+-------+
[2025-07-05T13:23:09.270+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                             |obj_num|
+----------+------+--------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_exchange_rate_d: DataFrameReader.jdbc() missing 1 required positional argument: 'url'|461    |
+----------+------+--------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T13:23:09.400+0000] {logging_mixin.py:188} INFO - +--------------------+
|                 _c0|
+--------------------+
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|CHAPTER;CHAPTER_N...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
|А;Балансовые счет...|
+--------------------+
[2025-07-05T13:23:12.599+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------+-------+
|timestamp |status|message                                           |obj_num|
+----------+------+--------------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_ledger_account_s|19     |
+----------+------+--------------------------------------------------+-------+
[2025-07-05T13:23:12.756+0000] {logging_mixin.py:188} INFO - +----------+------+---------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                              |obj_num|
+----------+------+---------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_ledger_account_s: DataFrameReader.jdbc() missing 1 required positional argument: 'url'|19     |
+----------+------+---------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T13:23:12.758+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-05T13:23:12.759+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-05T13:23:12.769+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=practice_etl_pipeline, task_id=transform_and_load, run_id=manual__2025-07-05T13:22:30.860692+00:00, execution_date=20250705T132230, start_date=20250705T132240, end_date=20250705T132312
[2025-07-05T13:23:12.800+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-05T13:23:12.816+0000] {taskinstance.py:3503} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-07-05T13:23:12.819+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
