[2025-07-05T16:05:38.897+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-05T16:05:38.909+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T16:05:28.283602+00:00 [queued]>
[2025-07-05T16:05:38.913+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T16:05:28.283602+00:00 [queued]>
[2025-07-05T16:05:38.914+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-07-05T16:05:38.922+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): transform_and_load> on 2025-07-05 16:05:28.283602+00:00
[2025-07-05T16:05:38.925+0000] {clientserver.py:570} INFO - Closing down clientserver connection
[2025-07-05T16:05:38.925+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=4893) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-07-05T16:05:38.927+0000] {standard_task_runner.py:63} INFO - Started process 5030 to run task
[2025-07-05T16:05:38.928+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'practice_etl_pipeline', 'transform_and_load', 'manual__2025-07-05T16:05:28.283602+00:00', '--job-id', '184', '--raw', '--subdir', 'DAGS_FOLDER/main.py', '--cfg-path', '/tmp/tmpsc37qgdf']
[2025-07-05T16:05:38.930+0000] {standard_task_runner.py:91} INFO - Job 184: Subtask transform_and_load
[2025-07-05T16:05:38.962+0000] {task_command.py:426} INFO - Running <TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T16:05:28.283602+00:00 [running]> on host 93b0937d74ff
[2025-07-05T16:05:39.011+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='practice_etl_pipeline' AIRFLOW_CTX_TASK_ID='transform_and_load' AIRFLOW_CTX_EXECUTION_DATE='2025-07-05T16:05:28.283602+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-07-05T16:05:28.283602+00:00'
[2025-07-05T16:05:39.011+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-05T16:05:40.504+0000] {logging_mixin.py:188} INFO - +----------+----------+-----------+-------------+
|   on_date|account_rk|currency_rk|  balance_out|
+----------+----------+-----------+-------------+
|31.12.2017|     24656|         35|     80533.62|
|31.12.2017|  34156756|         34|     99438.49|
|31.12.2017| 205685120|         36|     47671.54|
|31.12.2017|     19491|         34|      6783.41|
|31.12.2017|  31824186|         34|     45280.12|
|31.12.2017|     18164|         34|     86904.66|
|31.12.2017|     43180|         31|     80339.53|
|31.12.2017|  34156914|         34|    166637.75|
|31.12.2017|     13661|         35|     98296.65|
|31.12.2017|     13631|         35|    114589.94|
|31.12.2017|     13905|         34|     129554.0|
|31.12.2017|  25686468|         34|   2047171.37|
|31.12.2017| 298332234|         31|     94106.33|
|31.12.2017|     14878|         34|     26652.93|
|31.12.2017| 184239035|         62|    152671.71|
|31.12.2017|     13904|         34|      5541.83|
|31.12.2017|     17132|         34|2.001137158E7|
|31.12.2017|     24235|         35|     81577.79|
|31.12.2017|     38388|         30|      5754.62|
|31.12.2017|  34157147|         35|     13562.04|
+----------+----------+-----------+-------------+
only showing top 20 rows
[2025-07-05T16:05:44.786+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_ft_balance_f|114    |
+----------+------+-------------------------------------------+-------+
[2025-07-05T16:05:48.657+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.ft_balance_f (on_date, account_rk, currency_rk, balance_out)
        SELECT on_date, account_rk, currency_rk, balance_out FROM ds.temp_ft_balance_f
        ON CONFLICT (on_date, account_rk)
        DO UPDATE SET currency_rk = EXCLUDED.currency_rk, balance_out = EXCLUDED.balance_out
        
[2025-07-05T16:05:49.010+0000] {logging_mixin.py:188} INFO - +----------+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                                                                                                                                                                |obj_num|
+----------+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.ft_balance_f: column "on_date" is of type date but expression is of type text\nLINE 3:         SELECT on_date, account_rk, currency_rk, balance_out...\n                       ^\nHINT:  You will need to rewrite or cast the expression.\n|114    |
+----------+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T16:05:49.599+0000] {logging_mixin.py:188} INFO - +----------+-----------------+----------------+-------------+------------+
| oper_date|credit_account_rk|debet_account_rk|credit_amount|debet_amount|
+----------+-----------------+----------------+-------------+------------+
|09-01-2018|          1761691|           13630|     50022.58|    54944.45|
|09-01-2018|         18880783|           13630|     91167.18|    82820.46|
|09-01-2018|          8736635|           13630|     99508.82|    44841.59|
|09-01-2018|        393808409|           17436|      8245.63|    41044.51|
|09-01-2018|          1761691|           13630|     93600.14|    10481.79|
|09-01-2018|        393808409|           17436|     54070.47|    56847.36|
|10-01-2018|            37051|           13630|     46749.85|    92925.41|
|10-01-2018|            37051|           13630|     65690.32|    47907.92|
|10-01-2018|            37051|           13630|     95646.69|     61144.4|
|10-01-2018|            13985|           13630|     32754.88|    70084.15|
|10-01-2018|          1761691|           13630|     25635.33|    95777.71|
|10-01-2018|         10006159|           13630|     77549.53|    39308.12|
|10-01-2018|        409685020|           13630|     37166.75|    40855.85|
|10-01-2018|            17440|           17436|      5661.28|    89094.65|
|11-01-2018|         15698716|           13630|     82591.14|    46930.72|
|11-01-2018|        393808409|           17436|      5406.76|    76558.03|
|11-01-2018|            17132|           13630|      8759.27|     19925.6|
|12-01-2018|          8736635|           13630|     88985.14|    33007.19|
|12-01-2018|            37051|           13630|     95034.77|    90096.94|
|12-01-2018|          1761691|           13630|     89317.34|    32228.73|
+----------+-----------------+----------------+-------------+------------+
only showing top 20 rows
[2025-07-05T16:06:01.430+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_ft_posting_f|33892  |
+----------+------+-------------------------------------------+-------+
[2025-07-05T16:06:03.551+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------------+-------+
|timestamp |status|message                                                 |obj_num|
+----------+------+--------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.ft_posting_f: 'ft_posting_f'|33892  |
+----------+------+--------------------------------------------------------+-------+
[2025-07-05T16:06:03.805+0000] {logging_mixin.py:188} INFO - +----------------+--------------------+----------+--------------------+---------+-----------+-------------+
|data_actual_date|data_actual_end_date|account_rk|      account_number|char_type|currency_rk|currency_code|
+----------------+--------------------+----------+--------------------+---------+-----------+-------------+
|      2018-01-01|          2018-01-31|     13632|30114978200000004001|        А|         44|          978|
|      2018-01-01|          2018-01-31|     14104|30220840200838890001|        П|         35|          840|
|      2018-01-01|          2018-01-31|     14136|30220826800838890001|        П|         31|          826|
|      2018-01-01|          2018-01-31|     13872|30221978900000004100|        А|         44|          978|
|      2018-01-01|          2018-01-31|     14913|30223810300000001102|        П|         34|          643|
|      2018-01-01|          2018-01-31|  16582001|30114398000000004001|        А|         28|          398|
|      2018-01-01|          2018-01-31| 359656927|30114344900001102001|        А|         59|          344|
|      2018-01-01|          2018-01-31|     17132|30111810000000666001|        П|         34|          643|
|      2018-01-01|          2018-01-31| 331483502|30111810900001260001|        П|         34|          643|
|      2018-01-01|          2018-01-31|     43180|30222826000000009101|        П|         31|          826|
|      2018-01-01|          2018-01-31|     13811|30221978100000008100|        А|         44|          978|
|      2018-01-01|          2018-01-31|     13907|30114826900000009005|        А|         31|          826|
|      2018-01-01|          2018-01-31|     24775|30223810500000001106|        П|         34|          643|
|      2018-01-01|          2018-01-31|     24236|30222826400000309100|        П|         31|          826|
|      2018-01-01|          2018-01-31|  34156787|30236826400000009001|        П|         31|          826|
|      2018-01-01|          2018-01-31| 312741916|30111810300000829001|        П|         34|          643|
|      2018-01-01|          2018-01-31|     13731|30110978400000008005|        А|         44|          978|
|      2018-01-01|          2018-01-31|  18849846|30109810500000435003|        П|         34|          643|
|      2018-01-01|          2018-01-31|   1972647|30111810700000908001|        П|         34|          643|
|      2018-01-01|          2018-01-31| 298332839|30222978700000004095|        П|         44|          978|
+----------------+--------------------+----------+--------------------+---------+-----------+-------------+
only showing top 20 rows
[2025-07-05T16:06:07.075+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_account_d|112    |
+----------+------+-------------------------------------------+-------+
[2025-07-05T16:06:10.795+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_account_d (currency_rk, account_number, account_rk, currency_code, data_actual_date, char_type, data_actual_end_date)
        SELECT currency_rk, account_number, account_rk, currency_code, data_actual_date, char_type, data_actual_end_date FROM ds.temp_md_account_d
        ON CONFLICT (data_actual_date, account_rk)
        DO UPDATE SET currency_rk = EXCLUDED.currency_rk, account_number = EXCLUDED.account_number, currency_code = EXCLUDED.currency_code, char_type = EXCLUDED.char_type, data_actual_end_date = EXCLUDED.data_actual_end_date
        
[2025-07-05T16:06:11.002+0000] {logging_mixin.py:188} INFO - +----------+------+---------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                    |obj_num|
+----------+------+---------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_account_d: current transaction is aborted, commands ignored until end of transaction block\n|112    |
+----------+------+---------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T16:06:11.207+0000] {logging_mixin.py:188} INFO - +-----------+----------------+--------------------+-------------+-------------+
|currency_rk|data_actual_date|data_actual_end_date|currency_code|code_iso_char|
+-----------+----------------+--------------------+-------------+-------------+
|         61|      2017-05-11|          2050-12-31|          446|          MOP|
|  409611215|      2017-05-11|          2050-12-31|          972|          TJS|
|  205699734|      2017-05-11|          2050-12-31|          348|          HUF|
|         24|      2017-05-11|          2050-12-31|          784|          AED|
|         33|      2017-05-11|          2050-12-31|          999|            �|
|         27|      2017-05-11|          2050-12-31|          586|          PKR|
|  529511970|      2017-12-12|          2050-12-31|          944|          AZN|
|         62|      2017-05-11|          2050-12-31|          156|          CNY|
|         56|      2017-05-11|          2050-12-31|           12|          DZD|
|         55|      2017-05-11|          2050-12-31|          410|          KRW|
|  205699733|      2017-05-11|          2050-12-31|          203|          CZK|
|         54|      2017-05-11|          2050-12-31|          504|          MAD|
|         53|      2017-05-11|          2050-12-31|          422|          LBR|
|         63|      2017-05-11|          2050-12-31|          496|          MNT|
|         57|      2017-05-11|          2050-12-31|          417|          KGS|
|         48|      2017-05-11|          2050-12-31|           84|          BZD|
|  427870281|      2017-05-11|          2050-12-31|          933|          BYN|
|         46|      2017-05-11|          2050-12-31|           44|          BHS|
|         21|      2017-05-11|          2050-12-31|          949|          TRY|
|         39|      2017-05-11|          2050-12-31|           36|          AUD|
+-----------+----------------+--------------------+-------------+-------------+
only showing top 20 rows
[2025-07-05T16:06:14.530+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------+-------+
|timestamp |status|message                                     |obj_num|
+----------+------+--------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_currency_d|50     |
+----------+------+--------------------------------------------+-------+
[2025-07-05T16:06:18.344+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_currency_d (code_iso_char, data_actual_end_date, data_actual_date, currency_code, currency_rk)
        SELECT code_iso_char, data_actual_end_date, data_actual_date, currency_code, currency_rk FROM ds.temp_md_currency_d
        ON CONFLICT (currency_rk, data_actual_date)
        DO UPDATE SET code_iso_char = EXCLUDED.code_iso_char, data_actual_end_date = EXCLUDED.data_actual_end_date, currency_code = EXCLUDED.currency_code
        
[2025-07-05T16:06:18.549+0000] {logging_mixin.py:188} INFO - +----------+------+----------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                     |obj_num|
+----------+------+----------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_currency_d: current transaction is aborted, commands ignored until end of transaction block\n|50     |
+----------+------+----------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T16:06:18.789+0000] {logging_mixin.py:188} INFO - +----------------+--------------------+-----------+--------------+------------+
|data_actual_date|data_actual_end_date|currency_rk|reduced_cource|code_iso_num|
+----------------+--------------------+-----------+--------------+------------+
|      2018-01-27|          2018-01-29|         40|       7.26559|         578|
|      2018-01-12|          2018-01-12|         31|       76.8188|         826|
|      2017-12-30|          2018-01-09|         31|       77.6739|         826|
|      2018-01-20|          2018-01-22|         21|        14.979|         949|
|      2018-01-18|          2018-01-18|         25|       17.5519|         986|
|      2018-01-27|          2018-01-29|         59|       7.14005|         344|
|      2018-01-19|          2018-01-19|         39|       45.2999|          36|
|      2018-01-13|          2018-01-15|         36|       16.3907|         985|
|      2018-01-11|          2018-01-11|         57|      0.822464|         417|
|      2018-01-10|          2018-01-10|         36|        16.312|         985|
|      2017-12-30|          2018-01-09|         58|       35.2252|         100|
|      2018-01-12|          2018-01-12|  205699734|      0.219942|         348|
|      2018-01-26|          2018-01-26|         30|       59.3409|         756|
|      2017-12-30|          2018-01-09|         44|       68.8668|         978|
|      2017-12-30|          2018-01-09|  205699733|       2.69305|         203|
|      2018-01-27|          2018-01-29|         37|      0.512308|         392|
|      2018-01-20|          2018-01-22|         31|       78.8231|         826|
|      2016-07-01|          2050-12-31|         38|       31.8884|         974|
|      2018-01-12|          2018-01-12|         30|       58.1174|         756|
|      2017-12-30|          2018-01-09|  409611215|       6.52634|         972|
+----------------+--------------------+-----------+--------------+------------+
only showing top 20 rows
[2025-07-05T16:06:22.107+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------------+-------+
|timestamp |status|message                                          |obj_num|
+----------+------+-------------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_exchange_rate_d|460    |
+----------+------+-------------------------------------------------+-------+
[2025-07-05T16:06:25.870+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_exchange_rate_d (currency_rk, code_iso_num, reduced_cource, data_actual_end_date, data_actual_date)
        SELECT currency_rk, code_iso_num, reduced_cource, data_actual_end_date, data_actual_date FROM ds.temp_md_exchange_rate_d
        ON CONFLICT (data_actual_date, currency_rk)
        DO UPDATE SET code_iso_num = EXCLUDED.code_iso_num, reduced_cource = EXCLUDED.reduced_cource, data_actual_end_date = EXCLUDED.data_actual_end_date
        
[2025-07-05T16:06:26.087+0000] {logging_mixin.py:188} INFO - +----------+------+---------------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                          |obj_num|
+----------+------+---------------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_exchange_rate_d: current transaction is aborted, commands ignored until end of transaction block\n|460    |
+----------+------+---------------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T16:06:26.350+0000] {logging_mixin.py:188} INFO - +-------+----------------+--------------+--------------------+--------------------+---------------+--------------------+--------------+--------------------+--------------+----------+----------+
|chapter|    chapter_name|section_number|        section_name|     subsection_name|ledger1_account|ledger1_account_name|ledger_account| ledger_account_name|characteristic|start_date|  end_date|
+-------+----------------+--------------+--------------------+--------------------+---------------+--------------------+--------------+--------------------+--------------+----------+----------+
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30202|Обязательные резе...|             А|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30204|Обязательные резе...|             А|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30232|Незавершенные рас...|             П|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30111|Корреспондентские...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30102|Корреспондентские...|             А|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30114|Корреспондентские...|             А|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30109|Корреспондентские...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30110|Корреспондентские...|             А|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            304|Счета для осущест...|         30425|Средства в клирин...|             А|2013-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30236|Незавершенные пер...|             П|2013-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30223|Незавершенные пер...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30220|Незавершенные пер...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            304|Счета для осущест...|         30413|Средства на торго...|             А|2013-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30126|Резервы на возмож...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            304|Счета для осущест...|         30424|Средства в клирин...|             А|2016-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30222|Незавершенные пер...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30233|Незавершенные рас...|             А|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30221|Незавершенные пер...|             А|2008-01-01|2050-12-31|
+-------+----------------+--------------+--------------------+--------------------+---------------+--------------------+--------------+--------------------+--------------+----------+----------+
[2025-07-05T16:06:29.578+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------+-------+
|timestamp |status|message                                           |obj_num|
+----------+------+--------------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_ledger_account_s|18     |
+----------+------+--------------------------------------------------+-------+
[2025-07-05T16:06:33.321+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_ledger_account_s (is_loan, section_name, ledger1_account_name, is_overdue, max_term, ledger_acc_full_name_translit, is_reserve, start_date, section_number, ledger_account, is_reserved, chapter_name, is_rub_only, ledger_account_name, is_reserved_assets, min_term, ledger1_account, min_term_measure, chapter, is_correct, characteristic, is_resident, is_revaluation, subsection_name, max_term_measure, pair_account, end_date, is_interest)
        SELECT is_loan, section_name, ledger1_account_name, is_overdue, max_term, ledger_acc_full_name_translit, is_reserve, start_date, section_number, ledger_account, is_reserved, chapter_name, is_rub_only, ledger_account_name, is_reserved_assets, min_term, ledger1_account, min_term_measure, chapter, is_correct, characteristic, is_resident, is_revaluation, subsection_name, max_term_measure, pair_account, end_date, is_interest FROM ds.temp_md_ledger_account_s
        ON CONFLICT (ledger_account, start_date)
        DO UPDATE SET is_loan = EXCLUDED.is_loan, section_name = EXCLUDED.section_name, ledger1_account_name = EXCLUDED.ledger1_account_name, is_overdue = EXCLUDED.is_overdue, max_term = EXCLUDED.max_term, ledger_acc_full_name_translit = EXCLUDED.ledger_acc_full_name_translit, is_reserve = EXCLUDED.is_reserve, section_number = EXCLUDED.section_number, is_reserved = EXCLUDED.is_reserved, chapter_name = EXCLUDED.chapter_name, is_rub_only = EXCLUDED.is_rub_only, ledger_account_name = EXCLUDED.ledger_account_name, is_reserved_assets = EXCLUDED.is_reserved_assets, min_term = EXCLUDED.min_term, ledger1_account = EXCLUDED.ledger1_account, min_term_measure = EXCLUDED.min_term_measure, chapter = EXCLUDED.chapter, is_correct = EXCLUDED.is_correct, characteristic = EXCLUDED.characteristic, is_resident = EXCLUDED.is_resident, is_revaluation = EXCLUDED.is_revaluation, subsection_name = EXCLUDED.subsection_name, max_term_measure = EXCLUDED.max_term_measure, pair_account = EXCLUDED.pair_account, end_date = EXCLUDED.end_date, is_interest = EXCLUDED.is_interest
        
[2025-07-05T16:06:33.509+0000] {logging_mixin.py:188} INFO - +----------+------+----------------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                           |obj_num|
+----------+------+----------------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_ledger_account_s: current transaction is aborted, commands ignored until end of transaction block\n|18     |
+----------+------+----------------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T16:06:33.512+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-05T16:06:33.512+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-05T16:06:33.519+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=practice_etl_pipeline, task_id=transform_and_load, run_id=manual__2025-07-05T16:05:28.283602+00:00, execution_date=20250705T160528, start_date=20250705T160538, end_date=20250705T160633
[2025-07-05T16:06:33.563+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-05T16:06:33.574+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-05T16:06:33.577+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
