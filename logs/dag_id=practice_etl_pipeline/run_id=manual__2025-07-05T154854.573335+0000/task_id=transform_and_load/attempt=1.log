[2025-07-05T15:49:05.371+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-05T15:49:05.383+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T15:48:54.573335+00:00 [queued]>
[2025-07-05T15:49:05.387+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T15:48:54.573335+00:00 [queued]>
[2025-07-05T15:49:05.387+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-07-05T15:49:05.395+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): transform_and_load> on 2025-07-05 15:48:54.573335+00:00
[2025-07-05T15:49:05.398+0000] {clientserver.py:570} INFO - Closing down clientserver connection
[2025-07-05T15:49:05.399+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=1259) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-07-05T15:49:05.399+0000] {standard_task_runner.py:63} INFO - Started process 1398 to run task
[2025-07-05T15:49:05.401+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'practice_etl_pipeline', 'transform_and_load', 'manual__2025-07-05T15:48:54.573335+00:00', '--job-id', '170', '--raw', '--subdir', 'DAGS_FOLDER/main.py', '--cfg-path', '/tmp/tmpu5tejw_h']
[2025-07-05T15:49:05.403+0000] {standard_task_runner.py:91} INFO - Job 170: Subtask transform_and_load
[2025-07-05T15:49:05.437+0000] {task_command.py:426} INFO - Running <TaskInstance: practice_etl_pipeline.transform_and_load manual__2025-07-05T15:48:54.573335+00:00 [running]> on host 93b0937d74ff
[2025-07-05T15:49:05.482+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='practice_etl_pipeline' AIRFLOW_CTX_TASK_ID='transform_and_load' AIRFLOW_CTX_EXECUTION_DATE='2025-07-05T15:48:54.573335+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-07-05T15:48:54.573335+00:00'
[2025-07-05T15:49:05.483+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-05T15:49:06.865+0000] {logging_mixin.py:188} INFO - +----------+----------+-----------+-----------+
|   ON_DATE|ACCOUNT_RK|CURRENCY_RK|BALANCE_OUT|
+----------+----------+-----------+-----------+
|31.12.2017|     19491|         34|    6783.41|
|31.12.2017|     24656|         35|   80533.62|
|31.12.2017|     18165|         44|   65593.48|
|31.12.2017|     25068|         34|   53481.96|
|31.12.2017|     17442|         34|   33245.41|
|31.12.2017|     40266|         34|   35664.89|
|31.12.2017|  39577521|         34|   39070.65|
|31.12.2017|     13631|         35|  114589.94|
|31.12.2017| 222537244|         44|   34044.09|
|31.12.2017|     13660|         34|    34543.9|
|31.12.2017|     13632|         44|20082184.08|
|31.12.2017|  16582001|         28|     909.55|
|31.12.2017|     24236|         31|   53573.36|
|31.12.2017|     24232|         44|   35263.28|
|31.12.2017|     14104|         35|   25135.31|
|31.12.2017|     30277|         34| 3085995.11|
|31.12.2017|     15423|         35|   30405.32|
|31.12.2017|     25069|         34|   90009.64|
|31.12.2017|  56751763|         35|  578840.35|
|31.12.2017|     24753|         42|   243490.5|
+----------+----------+-----------+-----------+
only showing top 20 rows
[2025-07-05T15:49:11.155+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_ft_balance_f|114    |
+----------+------+-------------------------------------------+-------+
[2025-07-05T15:49:14.917+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.ft_balance_f (on_date, account_rk, currency_rk, balance_out)
        SELECT on_date, account_rk, currency_rk, balance_out FROM ds.temp_ft_balance_f
        ON CONFLICT (on_date, account_rk)
        DO UPDATE SET currency_rk = EXCLUDED.currency_rk, balance_out = EXCLUDED.balance_out
        
[2025-07-05T15:49:15.230+0000] {logging_mixin.py:188} INFO - +----------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                                                                                                                                                                                                   |obj_num|
+----------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.ft_balance_f: column "on_date" does not exist\nLINE 3:         SELECT on_date, account_rk, currency_rk, balance_out...\n                       ^\nHINT:  There is a column named "on_date" in table "ft_balance_f", but it cannot be referenced from this part of the query.\n|114    |
+----------+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T15:49:15.734+0000] {logging_mixin.py:188} INFO - +----------+-----------------+----------------+-------------+------------+
| OPER_DATE|CREDIT_ACCOUNT_RK|DEBET_ACCOUNT_RK|CREDIT_AMOUNT|DEBET_AMOUNT|
+----------+-----------------+----------------+-------------+------------+
|09-01-2018|         10006159|           13630|     65543.53|    96814.58|
|09-01-2018|          1648686|           13630|     35829.59|    71104.78|
|10-01-2018|         15698716|           13630|     97441.29|     72639.3|
|10-01-2018|         57223170|           13985|     79037.85|     6241.58|
|10-01-2018|         10006159|           13630|      1742.44|    92313.94|
|10-01-2018|            13630|           17440|     14891.72|     56512.4|
|10-01-2018|        409685020|           13630|     34143.00|    74401.42|
|10-01-2018|            13630|           17436|      7269.27|    11294.82|
|11-01-2018|         10006159|           13630|     49925.84|    89268.97|
|11-01-2018|         10006159|           13985|     57411.12|    90642.51|
|11-01-2018|        393808409|           17436|     77957.83|    72722.46|
|11-01-2018|        393808409|           17436|     69778.11|    25930.98|
|11-01-2018|        409685020|           13630|     75424.03|    39448.34|
|12-01-2018|        393808409|           17436|     39877.85|    86127.95|
|12-01-2018|        409685020|           13630|     84410.22|    95236.34|
|12-01-2018|            13685|           13632|     33711.44|      7121.3|
|15-01-2018|        393808409|           17436|     52917.96|    65865.92|
|15-01-2018|            37051|           13630|     39542.36|    81720.01|
|15-01-2018|        409685020|           13630|     16342.11|    87586.55|
|15-01-2018|            13985|           13630|     92316.99|    49230.67|
+----------+-----------------+----------------+-------------+------------+
only showing top 20 rows
[2025-07-05T15:49:27.267+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_ft_posting_f|33892  |
+----------+------+-------------------------------------------+-------+
[2025-07-05T15:49:29.447+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------------+-------+
|timestamp |status|message                                                 |obj_num|
+----------+------+--------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.ft_posting_f: 'ft_posting_f'|33892  |
+----------+------+--------------------------------------------------------+-------+
[2025-07-05T15:49:29.623+0000] {logging_mixin.py:188} INFO - +----------------+--------------------+----------+--------------------+---------+-----------+-------------+
|DATA_ACTUAL_DATE|DATA_ACTUAL_END_DATE|ACCOUNT_RK|      ACCOUNT_NUMBER|CHAR_TYPE|CURRENCY_RK|CURRENCY_CODE|
+----------------+--------------------+----------+--------------------+---------+-----------+-------------+
|      2018-01-01|          2018-01-31|     16024|30110810300000600001|        А|         34|          810|
|      2018-01-01|          2018-01-31|     25068|30222810400000001100|        П|         34|          643|
|      2018-01-01|          2018-01-31| 331483502|30111810900001260001|        П|         34|          643|
|      2018-01-01|          2018-01-31|  34156911|30110840400000198001|        А|         35|          840|
|      2018-01-01|          2018-01-31|  25686468|30111810000001102001|        П|         34|          643|
|      2018-01-01|          2018-01-31|     18164|30232810000450001001|        П|         34|          810|
|      2018-01-01|          2018-01-31|     22798|30114949000000004010|        А|         21|          949|
|      2018-01-01|          2018-01-31|  34156787|30236826400000009001|        П|         31|          826|
|      2018-01-01|          2018-01-31|     13906|30114756800000051003|        А|         30|          756|
|      2018-01-01|          2018-01-31|     13597|30110840900000008002|        А|         35|          840|
|      2018-01-01|          2018-01-31|     17244|30111810900000672001|        П|         34|          643|
|      2018-01-01|          2018-01-31|     24232|30222978900000304100|        П|         44|          978|
|      2018-01-01|          2018-01-31|     19492|30126810800000600100|        П|         34|          810|
|      2018-01-01|          2018-01-31|     13904|30204810500000002001|        А|         34|          643|
|      2018-01-01|          2018-01-31|     16223|30223810600000001103|        П|         34|          643|
|      2018-01-01|          2018-01-31|     15084|30220949800838890001|        П|         21|          949|
|      2018-01-01|          2018-01-31|     18006|30233978800450003001|        А|         44|          978|
|      2018-01-01|          2018-01-31|  48829156|30425810700000583002|        А|         34|          643|
|      2018-01-01|          2018-01-31|  34156872|30236978900000004001|        П|         44|          978|
|      2018-01-01|          2018-01-31|  67009360|30222840600000003101|        П|         35|          840|
+----------------+--------------------+----------+--------------------+---------+-----------+-------------+
only showing top 20 rows
[2025-07-05T15:49:32.932+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------+-------+
|timestamp |status|message                                    |obj_num|
+----------+------+-------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_account_d|112    |
+----------+------+-------------------------------------------+-------+
[2025-07-05T15:49:36.748+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_account_d (currency_rk, account_number, account_rk, currency_code, data_actual_date, char_type, data_actual_end_date)
        SELECT currency_rk, account_number, account_rk, currency_code, data_actual_date, char_type, data_actual_end_date FROM ds.temp_md_account_d
        ON CONFLICT (data_actual_date, account_rk)
        DO UPDATE SET currency_rk = EXCLUDED.currency_rk, account_number = EXCLUDED.account_number, currency_code = EXCLUDED.currency_code, char_type = EXCLUDED.char_type, data_actual_end_date = EXCLUDED.data_actual_end_date
        
[2025-07-05T15:49:36.951+0000] {logging_mixin.py:188} INFO - +----------+------+---------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                    |obj_num|
+----------+------+---------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_account_d: current transaction is aborted, commands ignored until end of transaction block\n|112    |
+----------+------+---------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T15:49:37.105+0000] {logging_mixin.py:188} INFO - +-----------+----------------+--------------------+-------------+-------------+
|CURRENCY_RK|DATA_ACTUAL_DATE|DATA_ACTUAL_END_DATE|CURRENCY_CODE|CODE_ISO_CHAR|
+-----------+----------------+--------------------+-------------+-------------+
|         55|      2017-05-11|          2050-12-31|          410|          KRW|
|         54|      2017-05-11|          2050-12-31|          504|          MAD|
|         29|      2017-05-11|          2050-12-31|          752|          SEK|
|         40|      2017-05-11|          2050-12-31|          578|          NOK|
|         41|      2017-05-11|          2050-12-31|          980|          UAH|
|         22|      2017-05-11|          2050-12-31|          788|          TND|
|         44|      2017-05-11|          2050-12-31|          978|          EUR|
|         57|      2017-05-11|          2050-12-31|          417|          KGS|
|         25|      2017-05-11|          2050-12-31|          986|          BRL|
|         23|      2017-05-11|          2050-12-31|          292|          GIB|
|  409611215|      2017-05-11|          2050-12-31|          972|          TJS|
|  529511970|      2017-12-12|          2050-12-31|          944|          AZN|
|         45|      2017-05-11|          2050-12-31|          196|          CYP|
|  529511969|      2017-12-12|          2050-12-31|          051|          AMD|
|         56|      2017-05-11|          2050-12-31|          012|          DZD|
|         53|      2017-05-11|          2050-12-31|          422|          LBR|
|         59|      2017-05-11|          2050-12-31|          344|          HKD|
|         32|      2017-05-11|          2050-12-31|          280|          DEM|
|         46|      2017-05-11|          2050-12-31|          044|          BHS|
|         31|      2017-05-11|          2050-12-31|          826|          GBP|
+-----------+----------------+--------------------+-------------+-------------+
only showing top 20 rows
[2025-07-05T15:49:40.289+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------+-------+
|timestamp |status|message                                     |obj_num|
+----------+------+--------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_currency_d|50     |
+----------+------+--------------------------------------------+-------+
[2025-07-05T15:49:44.031+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_currency_d (code_iso_char, data_actual_end_date, data_actual_date, currency_code, currency_rk)
        SELECT code_iso_char, data_actual_end_date, data_actual_date, currency_code, currency_rk FROM ds.temp_md_currency_d
        ON CONFLICT (currency_rk, data_actual_date)
        DO UPDATE SET code_iso_char = EXCLUDED.code_iso_char, data_actual_end_date = EXCLUDED.data_actual_end_date, currency_code = EXCLUDED.currency_code
        
[2025-07-05T15:49:44.228+0000] {logging_mixin.py:188} INFO - +----------+------+----------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                     |obj_num|
+----------+------+----------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_currency_d: current transaction is aborted, commands ignored until end of transaction block\n|50     |
+----------+------+----------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T15:49:44.391+0000] {logging_mixin.py:188} INFO - +----------------+--------------------+-----------+--------------+------------+
|DATA_ACTUAL_DATE|DATA_ACTUAL_END_DATE|CURRENCY_RK|REDUCED_COURCE|CODE_ISO_NUM|
+----------------+--------------------+-----------+--------------+------------+
|      2018-01-20|          2018-01-22|  205699733|        2.7355|         203|
|      2018-01-20|          2018-01-22|         31|       78.8231|         826|
|      2018-01-16|          2018-01-16|         50|        .88821|         356|
|      2018-01-23|          2018-01-23|  205699734|       .224186|         348|
|      2018-01-23|          2018-01-23|         30|       58.9303|         756|
|      2018-01-27|          2018-01-29|         62|       8.83381|         156|
|      2018-01-26|          2018-01-26|  427870281|       28.3471|         933|
|      2018-01-19|          2018-01-19|         39|       45.2999|         036|
|      2018-01-18|          2018-01-18|         50|       .885468|         356|
|      2018-01-31|          2018-01-31|         30|       60.0762|         756|
|      2018-01-26|          2018-01-26|         36|       16.7211|         985|
|      2018-01-19|          2018-01-19|         43|       9.30685|         208|
|      2018-01-27|          2018-01-29|  205699734|       .224745|         348|
|      2018-01-30|          2018-01-30|  205699733|        2.7551|         203|
|      2018-01-23|          2018-01-23|         57|       .821859|         417|
|      2018-01-12|          2018-01-12|         62|       8.75739|         156|
|      2018-01-27|          2018-01-29|         30|       59.6844|         756|
|      2018-01-11|          2018-01-11|  205699734|       .219546|         348|
|      2018-01-26|          2018-01-26|  529511970|       32.8413|         944|
|      2018-01-19|          2018-01-19|  427870281|       28.5225|         933|
+----------------+--------------------+-----------+--------------+------------+
only showing top 20 rows
[2025-07-05T15:49:47.665+0000] {logging_mixin.py:188} INFO - +----------+------+-------------------------------------------------+-------+
|timestamp |status|message                                          |obj_num|
+----------+------+-------------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_exchange_rate_d|460    |
+----------+------+-------------------------------------------------+-------+
[2025-07-05T15:49:51.393+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_exchange_rate_d (currency_rk, code_iso_num, reduced_cource, data_actual_end_date, data_actual_date)
        SELECT currency_rk, code_iso_num, reduced_cource, data_actual_end_date, data_actual_date FROM ds.temp_md_exchange_rate_d
        ON CONFLICT (data_actual_date, currency_rk)
        DO UPDATE SET code_iso_num = EXCLUDED.code_iso_num, reduced_cource = EXCLUDED.reduced_cource, data_actual_end_date = EXCLUDED.data_actual_end_date
        
[2025-07-05T15:49:51.605+0000] {logging_mixin.py:188} INFO - +----------+------+---------------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                          |obj_num|
+----------+------+---------------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_exchange_rate_d: current transaction is aborted, commands ignored until end of transaction block\n|460    |
+----------+------+---------------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T15:49:51.785+0000] {logging_mixin.py:188} INFO - +-------+----------------+--------------+--------------------+--------------------+---------------+--------------------+--------------+--------------------+--------------+----------+----------+
|CHAPTER|    CHAPTER_NAME|SECTION_NUMBER|        SECTION_NAME|     SUBSECTION_NAME|LEDGER1_ACCOUNT|LEDGER1_ACCOUNT_NAME|LEDGER_ACCOUNT| LEDGER_ACCOUNT_NAME|CHARACTERISTIC|START_DATE|  END_DATE|
+-------+----------------+--------------+--------------------+--------------------+---------------+--------------------+--------------+--------------------+--------------+----------+----------+
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30202|Обязательные резе...|             А|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30204|Обязательные резе...|             А|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30232|Незавершенные рас...|             П|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30114|Корреспондентские...|             А|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30109|Корреспондентские...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            304|Счета для осущест...|         30413|Средства на торго...|             А|2013-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30222|Незавершенные пер...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30233|Незавершенные рас...|             А|2014-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30110|Корреспондентские...|             А|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30221|Незавершенные пер...|             А|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30102|Корреспондентские...|             А|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30126|Резервы на возмож...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30236|Незавершенные пер...|             П|2013-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30220|Незавершенные пер...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            302|Счета кредитных о...|         30223|Незавершенные пер...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            304|Счета для осущест...|         30424|Средства в клирин...|             А|2016-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            301|Корреспондентские...|         30111|Корреспондентские...|             П|2008-01-01|2050-12-31|
|      А|Балансовые счета|             3|МЕЖБАНКОВСКИЕ ОПЕ...|МЕЖБАНКОВСКИЕ РАС...|            304|Счета для осущест...|         30425|Средства в клирин...|             А|2013-01-01|2050-12-31|
+-------+----------------+--------------+--------------------+--------------------+---------------+--------------------+--------------+--------------------+--------------+----------+----------+
[2025-07-05T15:49:54.970+0000] {logging_mixin.py:188} INFO - +----------+------+--------------------------------------------------+-------+
|timestamp |status|message                                           |obj_num|
+----------+------+--------------------------------------------------+-------+
|2025-07-05|ИНФО  |создана временная таблица temp_md_ledger_account_s|18     |
+----------+------+--------------------------------------------------+-------+
[2025-07-05T15:49:58.691+0000] {logging_mixin.py:188} INFO - 
        INSERT INTO ds.md_ledger_account_s (is_loan, section_name, ledger1_account_name, is_overdue, max_term, ledger_acc_full_name_translit, is_reserve, start_date, section_number, ledger_account, is_reserved, chapter_name, is_rub_only, ledger_account_name, is_reserved_assets, min_term, ledger1_account, min_term_measure, chapter, is_correct, characteristic, is_resident, is_revaluation, subsection_name, max_term_measure, pair_account, end_date, is_interest)
        SELECT is_loan, section_name, ledger1_account_name, is_overdue, max_term, ledger_acc_full_name_translit, is_reserve, start_date, section_number, ledger_account, is_reserved, chapter_name, is_rub_only, ledger_account_name, is_reserved_assets, min_term, ledger1_account, min_term_measure, chapter, is_correct, characteristic, is_resident, is_revaluation, subsection_name, max_term_measure, pair_account, end_date, is_interest FROM ds.temp_md_ledger_account_s
        ON CONFLICT (ledger_account, start_date)
        DO UPDATE SET is_loan = EXCLUDED.is_loan, section_name = EXCLUDED.section_name, ledger1_account_name = EXCLUDED.ledger1_account_name, is_overdue = EXCLUDED.is_overdue, max_term = EXCLUDED.max_term, ledger_acc_full_name_translit = EXCLUDED.ledger_acc_full_name_translit, is_reserve = EXCLUDED.is_reserve, section_number = EXCLUDED.section_number, is_reserved = EXCLUDED.is_reserved, chapter_name = EXCLUDED.chapter_name, is_rub_only = EXCLUDED.is_rub_only, ledger_account_name = EXCLUDED.ledger_account_name, is_reserved_assets = EXCLUDED.is_reserved_assets, min_term = EXCLUDED.min_term, ledger1_account = EXCLUDED.ledger1_account, min_term_measure = EXCLUDED.min_term_measure, chapter = EXCLUDED.chapter, is_correct = EXCLUDED.is_correct, characteristic = EXCLUDED.characteristic, is_resident = EXCLUDED.is_resident, is_revaluation = EXCLUDED.is_revaluation, subsection_name = EXCLUDED.subsection_name, max_term_measure = EXCLUDED.max_term_measure, pair_account = EXCLUDED.pair_account, end_date = EXCLUDED.end_date, is_interest = EXCLUDED.is_interest
        
[2025-07-05T15:49:58.887+0000] {logging_mixin.py:188} INFO - +----------+------+----------------------------------------------------------------------------------------------------------------------------------+-------+
|timestamp |status|message                                                                                                                           |obj_num|
+----------+------+----------------------------------------------------------------------------------------------------------------------------------+-------+
|2025-07-05|ОШИБКА|ошибка перелива данных в ds.md_ledger_account_s: current transaction is aborted, commands ignored until end of transaction block\n|18     |
+----------+------+----------------------------------------------------------------------------------------------------------------------------------+-------+
[2025-07-05T15:49:58.889+0000] {python.py:237} INFO - Done. Returned value was: None
[2025-07-05T15:49:58.889+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-05T15:49:58.894+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=practice_etl_pipeline, task_id=transform_and_load, run_id=manual__2025-07-05T15:48:54.573335+00:00, execution_date=20250705T154854, start_date=20250705T154905, end_date=20250705T154958
[2025-07-05T15:49:58.927+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-05T15:49:58.934+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-05T15:49:58.938+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
